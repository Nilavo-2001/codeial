import{createComment,deleteComment,getComment,createCommentLike}from"./comments_posts.js";let createPost=()=>{let t=$("#new-post-form");t.submit((function(e){console.log("cp clicked"),e.preventDefault(),$.ajax({type:"post",url:"/posts/create",data:t.serialize(),success:function(t){let e=getPost(t.data.posts);$("#posts-list-container > ul").prepend(e),deletePost(`#post-${t.data.posts._id} .delete-post-button`),createComment(`#post-${t.data.posts._id} .new-comment-form`),createPostLike(`#post-${t.data.posts._id} .post-like .like-symbol`),new Noty({theme:"relax",text:"Post Created",type:"success",layout:"topRight",timeout:1500}).show()},error:function(t){console.log(t)}})}))},getPost=t=>`<li id="post-${t._id}">\n       <p>\n         <small>\n           <button>\n             <a class="delete-post-button" href="/posts/destroy/${t._id}">\n               Delete\n             </a>\n           </button>\n         </small>\n         ${t.content}\n         <br />\n         <small> ${t.user.name} </small>\n       </p>\n       <div class="post-like">\n    <div data-id="${t._id}" class="like-symbol">\n      ü§ç\n    </div>\n    <div data-id="${t._id}" class="like-number">\n    ${t.likes.length>0?t.likes.length:""}\n    </div >\n  </div >\n  <div class="post-comments">\n\n    <form action="/comment/create" method="post" class="new-comment-form">\n      <input\n        type="text"\n        name="content"\n        placeholder="Type your comment here..."\n      />\n      <input type="hidden" name="post" value="${t._id}" />\n      <input type="submit" value="Add comment" />\n    </form>\n\n    <div class="post-comments-list">\n      <ul id="post-comments-${t._id}">\n\n      </ul>\n    </div>\n  </div>\n     </li >\n  `,deletePost=t=>{console.log("delete post"),$(t).click((function(t){console.log(""),t.preventDefault(),$.ajax({type:"get",url:$(this).prop("href"),success:function(t){$(`#post-${t.data.post_id}`).remove(),new Noty({theme:"relax",text:"Post Deleted",type:"success",layout:"topRight",timeout:1500}).show()},error:function(t){console.log(t)}})}))},createPostLike=t=>{$(t).click((function(t){const e=this.getAttribute("data-id");let o=this;$.ajax({type:"post",url:`/likes/toggle/?id=${e}&&type=Post`,success:function(t){console.log(t),t.deleted?o.innerHTML="ü§ç":o.innerHTML="‚ù§Ô∏è";const s=t.likes>0?t.likes:"";$(`.like-number[data-id=${e}]`).html(s)},error:function(t){console.log(t)}})}))};createPost(),createPostLike(".post-like .like-symbol"),deletePost(".delete-post-button");